<!-- u ovoj sekciji na ovoj stranici se nalaze svi nasi eventovi -->
<div class="event-container">
  <h1 class="page-title"> Svi događaji</h1>
  <!-- ovo je za sada ovako bice formirana nova loading komponenta koja ce se koristiti za sva ucitavnja a sad da ima nesto cisto -->
  <app-loading *ngIf="loading" [message]="'Učitavam dogadjaje...'">
  </app-loading>

  <!-- ovim radimo pretragu eventova po kriterijumima -->
  <div class="form-row">
    <mat-form-field class="form-field-small">
      <input matInput [formControl]="filter" placeholder="Unesite Naziv ili Grad ili Izvodjača ili Žanr">
      <mat-label>Pretraži</mat-label>
    </mat-form-field>
  </div>

  <!-- ovo prikazujemo ukoliko se zavrsilo ucitavanje a u bazi nemamo eventove -->
  <div *ngIf="!loading && filterList.length === 0" class="no-events">
    Nema koncerata za prikaz
  </div>

  <!-- ovo je glavni grid gde su prikazani svi eventovi proveravamo da l ije loading zavrsen i da li je vise od 0 eventova i tek tada kreiramo grid -->
  <div *ngIf="!loading && filterList.length > 0" class="events-grid">
    <!-- pravimo petlju kde iteriramo kao objekat event kroz nasu listu objekata events na klik pozivamo funkciju openEventsDetails i prosledjujemo joj id-->
    <div *ngFor="let event of filterList" class="event-card" (click)="openEventDetails(event.id)">
      <!-- sekcija slike eventa -->
      <div class="event-image">
        <!-- nismo krirali eksterni bucket vec se sike nalaze lokalno u nasem assets/images folderu dok nam baza sadrzi url do slike -->
        <img [src]="event.eventImageUrl || 'assets/images/party.jpg'" [alt]="event.eventName">
        <!-- ukoliko je rasprodato ucitavamo ans badge koji se nalazi na slici -->
        <span *ngIf="event.soldOut" class="sold-out-badge">Rasprodato</span>
      </div>

      <!-- ovde se nalaze detalji eventa kao sto su naziv eventa zanr i izvodjac -->
      <div class="event-details">
        <h2>{{ event.eventName }}</h2>
        <p class="artist">{{ event.artist }}</p>
        <p class="genre">{{ event.genre }}</p>
        <!-- koristimo Mat ikonice za prikaz ikonica ovde -->
        <div class="info-row">
          <mat-icon>calendar_today</mat-icon>
          <!-- ovde prikazujemo mesec odrzavanja koncerta koristimo pipe koji nam omogucava da iz date formata iz baze odsecemo mesec ito u formatu naziva na srpskom -->
          <span>{{ event.eventDate | date:'MMMM'}} </span>
        </div>

        <!-- u ovoj skeciji prikazujemo grad i drzavo odrzavanja -->
        <div class="info-row">
          <mat-icon>location_on</mat-icon>
          <span>{{ event.city }}, {{ event.country }}</span>
        </div>

        <!-- u ovoj sekciji prikazujemo godine, od koliko je dozovljen pristup -->
        <div class="info-row">
          <mat-icon>people</mat-icon>
          <span *ngIf="event.minAge > 0">{{ event.minAge }}+</span>
          <!-- ukoliko je postavljeno na 0 dozvoljeno je svim uzrastima -->
          <span *ngIf="event.minAge === 0">Svi uzrasti</span>
        </div>

        <!-- ovde prikazujemo opis gde preko naseg slice pajpa secemo tekst na 100 karaktera od 0 do 100  -->
        <p class="description">{{ event.description | slice:0:100 }}</p>


        <!-- ovde prikazujemo cenu kako smo lokalno postavili parametre na Srbiju, cenu samo deklarismeo na RSD i pajp currency odradi svu magiju konverzije u nas format -->
        <div class="price-row">


          <span class="price">
            {{ event.ticketPrice | currency:'RSD' }}
          </span>
          <!-- kupi fugme gde na osnovu toga da li je moguce kupiti kartu prikazujemo Kupi karte ili da se pridruzi listi -->
          <div *ngIf="!event.soldOut" class="ticket-button" (click)="onSubscribe(event.id, $event)">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24" fill="none">
              <path
                d="M15.8667 3.7804C16.7931 3.03188 17.8307 2.98644 18.9644 3.00233C19.5508 3.01055 19.844 3.01467 20.0792 3.10588C20.4524 3.2506 20.7494 3.54764 20.8941 3.92081C20.9853 4.15601 20.9894 4.4492 20.9977 5.03557C21.0136 6.16926 20.9681 7.20686 20.2196 8.13326C19.5893 8.91337 18.5059 9.32101 17.9846 10.1821C17.5866 10.8395 17.772 11.5203 17.943 12.2209L19.2228 17.4662C19.4779 18.5115 19.2838 19.1815 18.5529 19.9124C18.164 20.3013 17.8405 20.2816 17.5251 19.779L13.6627 13.6249L11.8181 15.0911C11.1493 15.6228 10.8149 15.8886 10.6392 16.2627C10.2276 17.1388 10.4889 18.4547 10.5022 19.4046C10.5096 19.9296 10.0559 20.9644 9.41391 20.9993C9.01756 21.0209 8.88283 20.5468 8.75481 20.2558L7.52234 17.4544C7.2276 16.7845 7.21552 16.7724 6.54556 16.4777L3.74415 15.2452C3.45318 15.1172 2.97914 14.9824 3.00071 14.5861C3.03565 13.9441 4.07036 13.4904 4.59536 13.4978C5.54532 13.5111 6.86122 13.7724 7.73734 13.3608C8.11142 13.1851 8.37724 12.8507 8.90888 12.1819L10.3751 10.3373L4.22103 6.47489C3.71845 6.15946 3.69872 5.83597 4.08755 5.44715C4.8185 4.7162 5.48851 4.52214 6.53377 4.77718L11.7791 6.05703C12.4797 6.22798 13.1605 6.41343 13.8179 6.0154C14.679 5.49411 15.0866 4.41074 15.8667 3.7804Z"
                stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path>
            </svg> Zapratite Event
          </div>
        </div>
      </div>
    </div>
  </div>
</div>